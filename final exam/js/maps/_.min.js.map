{"version":3,"sources":["imgfix.js","script.js"],"names":["imgs","document","querySelectorAll","forEach","call","item","attributes","src","value","searchHandler","event","input","getImages","encodeURIComponent","query","xhr","method","q","undefined","orientation","amount","amountOfImages","XMLHttpRequest","XDomainRequest","url","apiKey","open","onload","data","JSON","parse","responseText","e","emptyGrid","grid","innerHTML","style","height","hits","length","renderGrid","map","prepareData","initMasonry","send","Masonry","itemSelector","columnWidth","percentPosition","gutter","orient","webformatHeight","webformatWidth","text","tags","webformatURL","dataImages","elem","sizer","createElement","className","appendChild","i","max","img","backgroundImage","docReady","carousels","flicks","Flickity","prevNextButtons","autoPlay","wrapAround","contain","cellSelector","pageDots","nav","addEventListener","next","attachEvent","previous","querySelector","button","searchBtnListener"],"mappings":"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","file":"*.min.js","sourcesContent":["var imgs = document.querySelectorAll('img[data-x-src]');\n[].forEach.call(imgs, function(item) {\n  item.attributes.src.value = item.attributes['data-x-src'].value;\n});\n","'use strict';\ndocReady(function() {\n  getImages();\n});\n// carousels init\nvar carousels = document.querySelectorAll('.carousel');\nvar flicks = [];\n\n[].forEach.call(carousels, function(item, i) {\n  flicks[i] = new Flickity(item, {\n    prevNextButtons: false,\n    autoPlay: true,\n    wrapAround: true,\n    contain: true,\n    cellSelector: '.carousel__cell',\n    pageDots: false,\n  });\n\n  var nav = item.querySelectorAll('.carousel__nav');\n  // carousel__arrow--left\n  if (item.addEventListener) {\n    nav[0].addEventListener('click', function() {\n      flicks[i].next();\n    });\n  } else {\n    nav[0].attachEvent(\"onclick\", function() {\n      flicks[i].next();\n    });\n  }\n\n  // carousel__arrow--right\n  if (item.addEventListener) {\n    nav[1].addEventListener('click', function() {\n      flicks[i].previous();\n    });\n  } else {\n    nav[1].attachEvent(\"onclick\", function() {\n      flicks[i].previous();\n    });\n  }\n\n});\n\n\n// init data\nvar amountOfImages = 7,\n    apiKey = '1983864-eea8becd8812584cf0ae486ec';\n\n// get elements\nvar grid    = document.querySelector('.grid'),\n    input   = document.querySelectorAll('.search-block__input')[0],\n    button  = document.querySelectorAll('.search-block__btn')[0];\n\n// debugger;\n// fill grid\n\n// init button\nvar searchBtnListener;\nif (button.addEventListener) {\n  searchBtnListener = button.addEventListener('click', searchHandler);\n} else {\n  searchBtnListener = button.attachEvent(\"onclick\", searchHandler);\n}\n\nfunction searchHandler(event) {\n  var value = input.value;\n  if (value) {\n    getImages(encodeURIComponent(value));\n  }\n};\n\nfunction getImages(query) {\n  var xhr,\n      q = (query === undefined) ? '' : query,\n      orientation = 'all',\n      amount = amountOfImages,\n      method;\n\n  if(\"onload\" in new XMLHttpRequest()) {\n    xhr = new XMLHttpRequest();\n    method = 'https://'\n  } else {\n    xhr = new XDomainRequest();\n    method = 'http://'\n  }\n\n  var url = method +\n      'pixabay.com/api/?key=' + apiKey +\n      '&q=' + q +\n      '&orientation=' + orientation +\n      '&per_page=' + amount +\n      '&image_type=photo&pretty=true';\n\n  xhr.open('GET', url);\n  xhr.onload = function() {\n    var data;\n\n    try {\n      data = JSON.parse(xhr.responseText);\n    }\n    catch(e) {\n      emptyGrid();\n      grid.innerHTML = '<h2 class=\"content__title--partners\">Server error</h2>';\n      grid.style.height = '50px';\n      return;\n    }\n\n    if (data.hits.length < 7) {\n      emptyGrid();\n      grid.innerHTML = '<h2 class=\"content__title--partners\">Not found</h2>';\n      grid.style.height = '50px';\n      return;\n    }\n\n    emptyGrid();\n    // pick necessary data and render it\n    renderGrid(data.hits.map(prepareData));\n\n    initMasonry();\n\n  }\n\n  xhr.send();\n}\n\n/**\n *\n * Functions\n *\n */\n\nfunction initMasonry() {\n  var msnry = new Masonry(grid, {\n      itemSelector: '.grid__item',\n      columnWidth: 320,\n      percentPosition: true,\n      gutter: 0\n  });\n}\n\n// callback for map\nfunction prepareData(item) {\n  var orient;\n\n  if (item.webformatHeight > item.webformatWidth) {\n    orient = 'vertical';\n  } else if (item.webformatWidth / item.webformatHeight > 1.5) {\n    orient = 'horizontal';\n  } else {\n    orient = 'polaroid';\n  }\n\n  return {\n    text: item.tags,\n    orientation: orient,\n    url: item.webformatURL};\n}\n\nfunction emptyGrid() {\n  grid.innerHTML = '';\n}\n\nfunction renderGrid(dataImages) {\n  var elem;\n\n  var sizer = document.createElement('div');\n  sizer.className = 'grid__sizer';\n  grid.appendChild(sizer);\n\n  for (var i = 0, max = dataImages.length; i < max; i++) {\n    elem = document.createElement('div');\n    var img = document.createElement('div');\n    var text = document.createElement('span');\n\n    switch (dataImages[i].orientation) {\n      case 'vertical':\n        elem.className = 'grid__item grid__item--height2';\n        break;\n      case 'horizontal':\n        elem.className = 'grid__item grid__item--width2';\n        break;\n      case 'polaroid':\n        elem.className = 'grid__item';\n        break;\n      default:\n        elem.className = 'grid__item';\n    }\n\n    img.style.backgroundImage = 'url(\"' + dataImages[i].url + '\")';\n    img.className = 'grid__img';\n    elem.appendChild(img);\n\n    text.innerHTML = dataImages[i].text;\n    text.className = 'grid__title';\n    elem.appendChild(text);\n    grid.appendChild(elem);\n  }\n}\n"],"sourceRoot":"/source/"}